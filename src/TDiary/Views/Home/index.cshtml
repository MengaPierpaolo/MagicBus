@model TDiary.Providers.ViewModel.Model.HomeViewModel

@using Microsoft.AspNetCore.Identity
@using System.Security.Claims;
@using TDiary

@inject SignInManager<ApplicationUser> SignInManager
<div>
    @if (SignInManager.IsSignedIn(User))
    {
        <div class="row">
            <div class="col-sm-5">
                <h3>
                    Hello @User.Identities.First(
                            u => u.IsAuthenticated &&
                            u.HasClaim(c => c.Type == ClaimTypes.Name)).FindFirst(ClaimTypes.Name).Value, what'ya been up to?
                </h3>
                <a asp-action="Add" asp-controller="Trip" class="btn btn-primary btn-block">Been on a trip</a>
                <a asp-action="Add" asp-controller="Chow" class="btn btn-primary btn-block">Had some chow</a>
                <a asp-action="Add" asp-controller="Sight" class="btn btn-primary btn-block">Saw something funky</a>
                <a asp-action="Add" asp-controller="Nap" class="btn btn-primary btn-block">Took a noteworthy nap</a>
            </div>
            <div class="col-sm-7">
                @if (Model.ShowRecentExperiences)
                {
                    <h3>Recent experiences:</h3>
                    @foreach (var i in Model.RecentExperiences)
                    {
                        <div class="row experience">
                            <a class="col-sm-10 clickable-experience"
                               asp-action="Edit"
                               asp-controller="@i.ExperienceType"
                               asp-route-id="@i.Id"
                               asp-route-sourceLocation="Home"
                               title="Edit this @i.ExperienceType">
                                @i.FullExperience
                            </a>
                            <div class="col-sm-2 experience-toolbar">
                                <a class="btn btn-default function-button glyphicon glyphicon-arrow-up visible-@i.IsLastOfTheDay.ToString().ToLower()"
                                   asp-action="OrderActivityUp"
                                   asp-route-activityId="@i.Id"
                                   title="Move this @i.ExperienceType">
                                </a>
                                <a class="btn btn-default function-button glyphicon glyphicon-arrow-down visible-@i.IsFirstOfTheDay.ToString().ToLower()"
                                   asp-action="OrderActivityDown"
                                   asp-route-activityId="@i.Id"
                                   title="Move this @i.ExperienceType">
                                </a>
                                <a class="btn btn-default function-button function-button-delete glyphicon glyphicon-remove"
                                   asp-action="Delete"
                                   asp-controller="@i.ExperienceType"
                                   asp-route-id="@i.Id"
                                   asp-route-sourceLocation="Home"
                                   title="Delete this @i.ExperienceType">
                                </a>
                            </div>
                        </div>
                    }
                    <br>
                }
            </div>
        </div>
    }
    else
    {
        <div class="jumbotron">
            <div class="magic-bus-description">Magic Bus is a diary that brings joy and happiness to your travels...  <br /><br />
            ...but first, you need to @Html.ActionLink("log in!", "Login", "Account")</div>
        </div>
    }
</div>